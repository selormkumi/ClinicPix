import{a as z}from"./chunk-4MDRRECP.js";import{a as B}from"./chunk-AN47KTHP.js";import{a as P}from"./chunk-AF3QZ4WF.js";import{b as F,d as m,f as O,g as E,j as M,l as I,m as T,n as G,o as D,p as j,q as N,r as U,s as k,u as L}from"./chunk-UKKNGMUV.js";import{j as S,k as y,n as w}from"./chunk-7LQAGGHQ.js";import{Bb as d,Db as g,Kb as i,Mb as q,Ra as _,Ta as s,Ua as u,db as x,ha as f,ia as h,ib as c,pb as l,qc as b,sc as C,ub as o,vb as t,wb as v,zb as A}from"./chunk-47VD7EEE.js";function X(a,n){if(a&1&&(o(0,"div",9),i(1),t()),a&2){let e=g();s(),q(" ",e.loginErrorMessage," ")}}function Z(a,n){a&1&&(o(0,"p",23),i(1," Enter a valid email address. "),t())}function $(a,n){a&1&&(o(0,"p",23),i(1," Password must be at least 6 characters long. "),t())}function ee(a,n){if(a&1){let e=A();o(0,"form",10),d("ngSubmit",function(){f(e);let p=g();return h(p.submitForm())}),o(1,"div",11)(2,"label",12),i(3,"Email"),t(),v(4,"input",13),c(5,Z,2,0,"p",14),t(),o(6,"div",15)(7,"label",16),i(8,"Password"),t(),o(9,"div",17),v(10,"input",18),o(11,"img",19),d("click",function(){f(e);let p=g();return h(p.togglePasswordVisibility())}),t()(),c(12,$,2,0,"p",14),t(),o(13,"button",20),i(14," Login "),t(),o(15,"div",21)(16,"a",22),i(17,"Forgot Password?"),t()()()}if(a&2){let e=g();l("formGroup",e.loginForm),s(5),l("ngIf",e.isFieldInvalid("email")),s(5),l("type",e.showPassword?"text":"password"),s(),l("src",e.eyeIcon,_),s(),l("ngIf",e.isFieldInvalid("password")),s(),l("disabled",e.loginForm.invalid)}}function te(a,n){a&1&&(o(0,"p",23),i(1," OTP must be 6 digits. "),t())}function oe(a,n){if(a&1){let e=A();o(0,"form",24),d("ngSubmit",function(){f(e);let p=g();return h(p.verifyOtp())}),o(1,"h4",3),i(2,"Enter OTP"),t(),o(3,"p",25),i(4,"A 6-digit OTP has been sent to your email."),t(),o(5,"div",11)(6,"label",26),i(7,"One-Time Password (OTP)"),t(),v(8,"input",27),c(9,te,2,0,"p",14),t(),o(10,"button",28),i(11," Verify OTP "),t()()}if(a&2){let e=g();l("formGroup",e.otpForm),s(9),l("ngIf",e.otpForm.controls.otp.invalid&&e.otpForm.controls.otp.touched),s(),l("disabled",e.otpForm.invalid)}}function ie(a,n){a&1&&(o(0,"div",29)(1,"p"),i(2,"Don't have an account? "),o(3,"a",30),i(4,"Sign Up"),t()()())}var R=class a{constructor(n,e,r){this.router=n;this.fb=e;this.authService=r;this.loginForm=this.fb.group({email:["",[m.required,m.email]],password:["",[m.required,m.minLength(6)]]}),this.otpForm=this.fb.group({otp:["",[m.required,m.minLength(6),m.maxLength(6)]]})}loginForm;otpForm;loading=!1;isOtpSent=!1;email="";loginErrorMessage="";isFieldInvalid(n){let e=this.loginForm.get(n);return e?e.invalid&&(e.dirty||e.touched):!1}submitForm(){if(this.loginForm.valid){this.loading=!0,this.loginErrorMessage="";let n=this.loginForm.value;this.email=n.email,this.authService.login(n).subscribe(e=>{console.log("\u2705 Login Successful:",e),this.isOtpSent=!0,this.loading=!1},e=>{console.error("\u274C Login Error:",e);let r="Invalid email or password. Please try again.";e.status===403?r="Your account has been deactivated. Please contact the administrator.":e.status===500?r="Server error. Please try again later.":e.status===0&&(r="Network error. Check your connection."),this.loginErrorMessage=r,this.loading=!1})}else Object.values(this.loginForm.controls).forEach(n=>n.markAsTouched()),console.log("\u26A0\uFE0F Please fill in all fields correctly.")}verifyOtp(){if(this.otpForm.valid){let n={email:this.email,otp:this.otpForm.controls.otp.value};this.authService.verifyOtp(n).subscribe(e=>{if(console.log("\u2705 OTP Verified:",e),this.authService.storeToken(e.token),!e.user||!e.user.role){console.error("\u274C Role is missing in the response:",e),alert("Login failed. Missing user role.");return}localStorage.setItem("user",JSON.stringify({email:e.user.email,userName:e.user.userName||e.user.username||e.user.name||"Unknown",role:e.user.role,userId:e.user.id||null})),this.redirectBasedOnRole(e.user.role)},e=>{console.error("\u274C OTP Verification Error:",e),alert(e.error?.message||"Invalid OTP. Please try again.")})}else console.log("\u26A0\uFE0F Enter a valid OTP.")}redirectBasedOnRole(n){let r={patient:"/patient/dashboard",provider:"/provider/dashboard",admin:"/admin/dashboard"}[n.toLowerCase()];r?this.router.navigate([r]):alert("Your role does not have an assigned dashboard.")}showPassword=!1;eyeOpenIcon="https://cdn-icons-png.flaticon.com/512/159/159604.png";eyeClosedIcon="https://cdn-icons-png.flaticon.com/512/565/565655.png";eyeIcon=this.eyeClosedIcon;togglePasswordVisibility(){this.showPassword=!this.showPassword,this.eyeIcon=this.showPassword?this.eyeOpenIcon:this.eyeClosedIcon}static \u0275fac=function(e){return new(e||a)(u(S),u(k),u(P))};static \u0275cmp=x({type:a,selectors:[["app-login"]],decls:14,vars:4,consts:[[1,"header","text-center"],[1,"container"],[1,"card","login-card"],[1,"text-center"],["class","alert alert-danger",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","mt-3",3,"formGroup","ngSubmit",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"footer","text-center","mt-4"],[1,"alert","alert-danger"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Enter your email","required","",1,"form-control"],["class","error",4,"ngIf"],[1,"form-group","password-field"],["for","password"],[1,"password-container"],["id","password","formControlName","password","placeholder","Enter your password","required","",1,"form-control",3,"type"],["alt","Toggle Password Visibility",1,"toggle-password-icon",3,"click","src"],["type","submit",1,"btn","btn-primary","w-100","mt-3",3,"disabled"],[1,"text-center","mt-2"],["routerLink","/auth/forgot-password",1,"link"],[1,"error"],[1,"mt-3",3,"ngSubmit","formGroup"],[1,"info-text","text-center"],["for","otp"],["type","text","id","otp","formControlName","otp","placeholder","Enter OTP","required","","maxlength","6",1,"form-control"],["type","submit",1,"btn","btn-success","w-100","mt-2",3,"disabled"],[1,"text-center","mt-4"],["routerLink","/auth/signup",1,"link"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"h1"),i(2,"ClinicPix"),t()(),o(3,"div",1)(4,"div",2)(5,"h2",3),i(6,"Login"),t(),c(7,X,2,1,"div",4)(8,ee,18,6,"form",5)(9,oe,12,3,"form",6)(10,ie,5,0,"div",7),t()(),o(11,"div",8)(12,"p"),i(13,"\xA9 2025 Secure Medical Image Sharing Platform"),t()()),e&2&&(s(7),l("ngIf",r.loginErrorMessage),s(),l("ngIf",!r.isOtpSent),s(),l("ngIf",r.isOtpSent),s(),l("ngIf",!r.isOtpSent))},dependencies:[C,b,L,M,F,O,E,N,U,I,T,w,y],styles:["body[_ngcontent-%COMP%]{margin:0;font-family:Roboto,sans-serif;background-color:#f4f4f9}.header[_ngcontent-%COMP%]{background-color:#2c3e50;color:#fff;padding:20px;text-align:center}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.card[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 4px 6px #0000001a;width:350px;padding:20px}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:5px;display:block}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:14px}.password-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding-right:40px}.toggle-password-icon[_ngcontent-%COMP%]{position:absolute;right:10px;width:20px;height:20px;cursor:pointer}.btn[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:10px;width:100%;border-radius:5px;cursor:pointer;font-size:16px}.btn[_ngcontent-%COMP%]:hover{background-color:#2980b9}.footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-size:12px;color:#7f8c8d}"]})};function ne(a,n){a&1&&(o(0,"p",26),i(1,"\u26A0\uFE0F Please select a role."),t())}function re(a,n){a&1&&(o(0,"p",26),i(1," \u26A0\uFE0F Full name is required. "),t())}function ae(a,n){a&1&&(o(0,"p",26),i(1," \u26A0\uFE0F Enter a valid email address. "),t())}function le(a,n){a&1&&(o(0,"p",26),i(1," \u26A0\uFE0F Password is required (at least 6 characters). "),t())}var V=class a{constructor(n,e,r){this.fb=n;this.router=e;this.authService=r;this.signupForm=this.fb.group({role:["",m.required],userName:["",[m.required,m.minLength(3)]],email:["",[m.required,m.email]],password:["",[m.required,m.minLength(6)]]})}signupForm;showPassword=!1;eyeOpenIcon="https://cdn-icons-png.flaticon.com/512/159/159604.png";eyeClosedIcon="https://cdn-icons-png.flaticon.com/512/565/565655.png";get eyeIcon(){return this.showPassword?this.eyeOpenIcon:this.eyeClosedIcon}togglePasswordVisibility(){this.showPassword=!this.showPassword}roleTouched=!1;isFieldInvalid(n){let e=this.signupForm.get(n);return e?e.invalid&&(e.dirty||e.touched):!1}submitForm(){if(this.signupForm.valid){let n=this.signupForm.value;this.authService.signup(n).subscribe(e=>{alert("\u2705 Signup successful! Please log in to continue."),this.router.navigate(["/auth/login"])},e=>{alert("\u274C Signup failed: "+(e.error.message||"Please try again."))})}else Object.values(this.signupForm.controls).forEach(n=>n.markAsTouched()),console.log("\u26A0\uFE0F Form is incomplete. Please fill all required fields.")}onFieldFocus(){this.signupForm.controls.role.value||(this.roleTouched=!0)}static \u0275fac=function(e){return new(e||a)(u(k),u(S),u(P))};static \u0275cmp=x({type:a,selectors:[["app-signup"]],decls:46,vars:8,consts:[[1,"header","text-center"],[1,"container"],[1,"card","login-card"],[1,"text-center"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","role"],["id","role","formControlName","role","required","",1,"form-control"],["value",""],["value","patient"],["value","provider"],["class","error",4,"ngIf"],[1,"form-group","mt-2"],["for","userName"],["type","text","id","userName","formControlName","userName","placeholder","Enter your user name","required","",1,"form-control",3,"focus"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Enter your email","required","",1,"form-control",3,"focus"],[1,"form-group","password-field","mt-2"],["for","password"],[1,"password-container"],["id","password","formControlName","password","placeholder","Create a strong password","required","",1,"form-control",3,"focus","type"],["alt","Toggle Password Visibility",1,"toggle-password-icon",3,"click","src"],["type","submit",1,"btn","btn-primary","w-100","mt-3",3,"disabled"],[1,"text-center","mt-4"],["routerLink","/auth/login",1,"link"],[1,"footer","text-center","mt-4"],[1,"error"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"h1"),i(2,"ClinicPix"),t()(),o(3,"div",1)(4,"div",2)(5,"h2",3),i(6,"Sign Up"),t(),o(7,"form",4),d("ngSubmit",function(){return r.submitForm()}),o(8,"div",5)(9,"label",6),i(10,"Role"),t(),o(11,"select",7)(12,"option",8),i(13,"Select your role"),t(),o(14,"option",9),i(15,"Patient"),t(),o(16,"option",10),i(17,"Healthcare Provider"),t()(),c(18,ne,2,0,"p",11),t(),o(19,"div",12)(20,"label",13),i(21,"User Name"),t(),o(22,"input",14),d("focus",function(){return r.onFieldFocus()}),t(),c(23,re,2,0,"p",11),t(),o(24,"div",12)(25,"label",15),i(26,"Email"),t(),o(27,"input",16),d("focus",function(){return r.onFieldFocus()}),t(),c(28,ae,2,0,"p",11),t(),o(29,"div",17)(30,"label",18),i(31,"Password"),t(),o(32,"div",19)(33,"input",20),d("focus",function(){return r.onFieldFocus()}),t(),o(34,"img",21),d("click",function(){return r.togglePasswordVisibility()}),t()(),c(35,le,2,0,"p",11),t(),o(36,"button",22),i(37," Sign Up "),t()(),o(38,"div",23)(39,"p"),i(40,"Already have an account? "),o(41,"a",24),i(42,"Login"),t()()()()(),o(43,"div",25)(44,"p"),i(45,"\xA9 2025 Secure Medical Image Sharing Platform"),t()()),e&2&&(s(7),l("formGroup",r.signupForm),s(11),l("ngIf",r.roleTouched),s(5),l("ngIf",r.isFieldInvalid("userName")),s(5),l("ngIf",r.isFieldInvalid("email")),s(5),l("type",r.showPassword?"text":"password"),s(),l("src",r.eyeIcon,_),s(),l("ngIf",r.isFieldInvalid("password")),s(),l("disabled",r.signupForm.invalid))},dependencies:[C,b,L,M,D,j,F,G,O,E,N,I,T,w,y],styles:["body[_ngcontent-%COMP%]{margin:0;font-family:Roboto,sans-serif;background-color:#f4f4f9}.header[_ngcontent-%COMP%]{background-color:#2c3e50;color:#fff;padding:20px;text-align:center}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.card[_ngcontent-%COMP%]{background:#fff;border-radius:10px;box-shadow:0 4px 6px #0000001a;width:350px;padding:20px}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:5px;display:block}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:14px}.password-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.password-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding-right:40px}.toggle-password-icon[_ngcontent-%COMP%]{position:absolute;right:10px;width:20px;height:20px;cursor:pointer}.btn[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:10px;width:100%;border-radius:5px;cursor:pointer;font-size:16px}.btn[_ngcontent-%COMP%]:hover{background-color:#2980b9}.footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px;font-size:12px;color:#7f8c8d}"]})};var Fe=[{path:"login",component:R},{path:"signup",component:V},{path:"forgot-password",component:z},{path:"reset-password",component:B}];export{Fe as AUTH_ROUTES};
